# Copilot 指示書 — SHUYU

## 概要
SHUYU は WPF (C# + XAML) ベースのデスクトップアプリです。Copilot はこのリポジトリの既存設計・スタイル・パフォーマンス要件を維持しつつ変更を提案してください。 以下の指示に従い、コード生成・修正を行ってください。

## 言語
- Copilot は、このリポジトリで行うすべてのレビュー・コメント・提案を **日本語で** 記述してください。

## 優先言語とファイル
- メイン言語: C# (.cs)、XAML (.xaml)
- 補助: リソース/ローカライズ (Resources/Strings.Designer.cs)
- 主要領域: UI ウィンドウ（MainWindow, CaptureOverlayWindow, PinnedWindow, SettingsWindow）、Service フォルダ、App.xaml

## 一般ルール
- セキュリティ上の秘密（APIキー、証明など）を生成・埋め込まない。
- 既存の命名規則・アクセス修飾子・null 設定に従う。
- ビルドは Visual Studio または `dotnet build` を想定。動作確認手順を PR に記載する。
- 変更は最小限にし、UI 振る舞いを変える場合はスクリーンショット/手順を提供する。

## UI / WPF 固有の注意
- UI スレッド: 長時間処理は非同期化し Dispatcher/Task を適切に使う。
- データバインディング: INotifyPropertyChanged の実装や ViewModel パターンに整合するコードを推奨。
- リソース/ローカライズ: Strings.Designer.cs を使った文字列管理を優先し、ハードコーディングしない。
- ウィンドウ（CaptureOverlayWindow 等）の動作やスクリーンキャプチャ処理では性能と権限に注意する（遅延やフリーズを避ける）。

## 設計・テスト
- 新規機能・バグ修正には単体テスト（xUnit / MSTest / NUnit のいずれか）を追加することを推奨。テストが困難な UI ロジックは分離してテスト可能にする。
- 依存注入を使う場合はインターフェースを明示し、テスト時にモック可能にする。

## コード品質
- フォーマッター/リンターに従う（プロジェクトで設定されていればそれに従う）。
- 公開 API を変更する場合は後方互換性を優先し、破壊的変更は明示して PR に記載する。
- パフォーマンスやメモリ使用量に影響する変更はベンチマーク/プロファイリング指標を付ける。

## コミット / PR
- コミットメッセージ: 「種類(scope): 概要」形式（例: fix(settings): handle null config）。
- PR には変更概要、ビルド手順、動作確認手順、関連 Issue を必須で記載する。

## 禁止事項
- ライセンス違反となるコードやクローズドソースの無断コピーを貼らない。
- 有害・違法な用途を助長するコードは生成しない。

## 例（簡潔）
- 要求: CaptureOverlayWindow に非同期キャプチャ機能を追加
  - 期待: UI 処理をブロックしない実装、テスト可能なサービス抽象、手動テスト手順
- 要求: Settings 保存ロジック修正
  - 期待: 既存設定との互換性維持、単体テスト追加
